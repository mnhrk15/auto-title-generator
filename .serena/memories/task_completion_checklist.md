# タスク完了時のチェックリスト

## コード変更後の確認事項

### 1. テスト実行
```bash
# すべてのテストを実行
pytest tests/ --asyncio-mode=auto

# 変更した機能に関連するテストを実行
pytest tests/test_[関連ファイル名].py -v
```

### 2. リント・フォーマット
- このプロジェクトでは明示的なリント・フォーマットツールは設定されていませんが、以下の点を確認：
  - Pythonの標準的なコーディング規約（PEP 8）に準拠
  - 型ヒントが適切に使用されているか
  - Docstringが適切に記述されているか

### 3. ログ確認
- 変更した機能のログ出力を確認
- エラーログがないか確認
```bash
tail -f logs/app.log
```

### 4. 動作確認
- 開発サーバーで動作確認
```bash
python run.py
```
- ブラウザで http://localhost:5000 にアクセスして動作確認

### 5. 非同期処理の確認
- 非同期関数が正しく動作するか確認
- エラーハンドリングが適切か確認
- リソースのクリーンアップが適切か確認

### 6. 環境変数の確認
- 必要な環境変数が設定されているか確認
- `.env`ファイルが正しく設定されているか確認

### 7. パフォーマンス確認
- AI生成速度が期待通りか確認（目標: 20件で8-10秒）
- メモリ使用量が適切か確認
- スクレイピングのレート制限が適切か確認

## コミット前の確認事項

### 1. 変更内容の確認
```bash
# 変更されたファイルを確認
git status

# 変更内容を確認
git diff
```

### 2. 不要なファイルの削除
- 一時ファイルやキャッシュファイルが含まれていないか確認
- `__pycache__/`ディレクトリが含まれていないか確認

### 3. 機密情報の確認
- APIキーやシークレットがコードに含まれていないか確認
- `.env`ファイルがコミットされていないか確認

### 4. テストの通過確認
- すべてのテストが通過することを確認
- 新しく追加した機能のテストが含まれているか確認

## デプロイ前の確認事項

### 1. 本番環境設定の確認
- `gunicorn.conf.py`の設定が適切か確認
- 環境変数が本番環境で正しく設定されているか確認

### 2. パフォーマンス設定の確認
- MAX_PAGES=1（本番環境）
- thinking_budget=0設定
- ワーカー数が適切か確認（2ワーカー）

### 3. ログ設定の確認
- ログレベルが適切か確認（本番環境ではINFO以上）
- ログファイルのローテーション設定が適切か確認

### 4. エラーハンドリングの確認
- エラー時のフォールバック動作が適切か確認
- ユーザーに適切なエラーメッセージが表示されるか確認

## 特集キーワード機能の確認事項

### 1. JSONファイルの確認
- `app/data/featured_keywords.json`が正しい形式か確認
- 性別フィルタリングが正しく動作するか確認

### 2. APIエンドポイントの確認
- `/api/featured-keywords`が正しく動作するか確認
- 性別パラメータによるフィルタリングが正しく動作するか確認

### 3. UI動作の確認
- 特集キーワードボタンが正しく表示されるか確認
- 性別変更時にキーワードリストが更新されるか確認
- キーワード選択時の視覚的フィードバックが適切か確認

## よくある問題と対処法

### テストが失敗する場合
1. 環境変数が正しく設定されているか確認
2. 非同期テストのデコレータが適切か確認
3. モックが正しく設定されているか確認

### アプリケーションが起動しない場合
1. 仮想環境が有効化されているか確認
2. 依存パッケージがインストールされているか確認
3. 環境変数（特にGEMINI_API_KEY）が設定されているか確認

### スクレイピングが失敗する場合
1. ネットワーク接続を確認
2. SSL設定を確認（開発環境では無効化）
3. レート制限設定を確認

### AI生成が失敗する場合
1. GEMINI_API_KEYが正しく設定されているか確認
2. APIのレート制限を確認
3. デュアルSDKのフォールバック動作を確認
